---
applications:
  web:
    name: celery-web
    depends-on: worker
    mem: 128M
    services:
      rabbit-celery:
        type: rabbitmq
    stackato:
      requirements:
        pypm: [celery]
      min_version:
        server: 0.9.0.143
        client: 1.0

  worker:
    name: celery-worker
    mem: 128
    framework:
      name: python
    services:
      rabbit-celery:
        type: rabbitmq
    stackato:
      processes:
        web: celeryd
      requirements:
        pypm: [celery]
      hooks:
        pre-running:
          - sudo cp $HOME/fstab /etc/fstab
          - sudo mount /dev/shm
      min_version:
        server: 0.9.0.143
        client: 1.0
